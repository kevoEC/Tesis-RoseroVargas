import{u as S,c as D,r as s,j as e,G as k,C as w,d as E,e as N,a as I,t as T}from"./index-ABbIRX4x.js";import{g as _,d as F}from"./SolicitudService-BRPNL4PC.js";import{T as z}from"./TablaCustom2-DS7_i3Ng.js";import{D as A,a as L,b as M,c as P,d as H}from"./jspdf.plugin.autotable-CZR7NrjE.js";import R from"./SolicitudInversionForm-Bb3Az7kz.js";import"./select-C75wXMdb.js";import"./index-CFqNEq9z.js";import"./TipoClienteService-BAK64bBK.js";import"./TipoIdentificacionService-BJmrDHaB.js";function O({fase:l}){const a={1:{label:"Llenado de Información",color:"bg-gray-200 text-gray-700"},2:{label:"Tareas",color:"bg-blue-100 text-blue-700"},3:{label:"Rechazado",color:"bg-yellow-100 text-yellow-700"},4:{label:"Finalizado",color:"bg-green-100 text-green-700"}}[l]||{label:`Fase ${l}`,color:"bg-gray-100 text-gray-500"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${a.color}`,children:a.label})}function Q(){const l=S(),{roles:t,user:a}=D(),[p,c]=s.useState([]),[x,n]=s.useState(!1),[f,d]=s.useState(!0),u=s.useRef(!1),m=t.includes("Externo")||t.includes("Asesor Comercial"),g=m?"Mis Solicitudes":"Lista de Solicitudes de Inversión";s.useEffect(()=>{(async()=>{d(!0);try{let o=(await _()).data;m&&(o=o.filter(C=>C.idUsuarioPropietario===a.id)),t.includes("Externo")&&o.length===0&&!u.current&&(T.info("Es necesario que te crees como prospecto para poder crear una solicitud de inversión."),u.current=!0),c(o)}catch(r){console.error("Error al cargar solicitudes:",r)}finally{d(!1)}})()},[t,a]);const b=i=>{l(`/solicitudes/editar/${i.idSolicitudInversion}`)},h=async i=>{try{await F(i.idSolicitudInversion),c(r=>r.filter(o=>o.idSolicitudInversion!==i.idSolicitudInversion))}catch(r){console.error("Error al eliminar solicitud:",r)}},y=()=>n(!0),j=()=>n(!1),v=[{key:"idSolicitudInversion",label:"",render:i=>e.jsxs("div",{className:"flex items-center justify-center group relative text-gray-500",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6M5 4v16h14V4H5zm2 2h10v12H7V6z"})}),e.jsxs("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 text-xs text-white bg-zinc-800 px-2 py-0.5 rounded shadow opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-50 whitespace-nowrap",children:["ID: ",i]})]})},{key:"faseProceso",label:"Fase",render:i=>e.jsx(O,{fase:i})},{key:"tipoSolicitud",label:"Tipo de Solicitud",render:(i,r)=>{var o;return((o=r.identificacion)==null?void 0:o.nombreTipoSolicitud)||"—"}},{key:"numeroDocumento",label:"N° Documento",render:(i,r)=>{var o;return((o=r.identificacion)==null?void 0:o.numeroDocumento)||"—"}},{key:"tipoDocumento",label:"Tipo de Documento",render:(i,r)=>{var o;return((o=r.identificacion)==null?void 0:o.nombreTipoDocumento)||"—"}},{key:"nombreCompleto",label:"Nombre completo",render:(i,r)=>r.nombreCompletoProspecto||"—"},{key:"tipoCliente",label:"Tipo de Cliente",render:(i,r)=>{var o;return((o=r.identificacion)==null?void 0:o.nombreTipoCliente)||"—"}},{key:"nombrePropietario",label:"Propietario",render:i=>i||"—"}];return e.jsxs("div",{className:"relative",children:[e.jsx(k,{visible:f,message:"Cargando solicitudes..."}),e.jsxs(w,{className:"w-full border border-muted rounded-xl shadow-[0_4px_10px_rgba(0,0,0,0.12)]",children:[e.jsx(E,{children:e.jsx(N,{className:"text-3xl font-bold text-gray-900 flex items-center",children:g})}),e.jsx(I,{children:e.jsx(z,{columns:v,data:p,mostrarEditar:!0,mostrarAgregarNuevo:!1,mostrarEliminar:!0,onAgregarNuevoClick:y,onEditarClick:b,onEliminarClick:h})})]}),e.jsx(A,{open:x,onOpenChange:n,className:"min-w-3xl",children:e.jsxs(L,{className:"min-w-3xl",children:[e.jsxs(M,{children:[e.jsx(P,{children:"Agregar Solicitud"}),e.jsx(H,{children:"Completa la información de la nueva solicitud"})]}),e.jsx(R,{onClose:j})]})})]})}export{Q as default};
