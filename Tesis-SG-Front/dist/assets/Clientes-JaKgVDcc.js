import{u as R,c as x,r as d,j as a,G as k,C as v,d as D,e as U,U as p,a as P,t as g}from"./index-ABbIRX4x.js";import{T as G}from"./TablaCustom2-DS7_i3Ng.js";import{b as M,c as _}from"./ClienteService-Crd2CGs_.js";import"./jspdf.plugin.autotable-CZR7NrjE.js";const C={Administrador:1,"Asesor Comercial":2,"Asesor Legal":3,"Analista de riesgos":4,"Analista de emisión":5,"Analista financiero":6,"Gerencia Comercial":7,Gerencia:8,Externo:9};function z(){const f=R(),{user:i,roles:s}=x?x():{user:null,roles:[]},u=()=>{var l;if(i&&(s!=null&&s.length)){const c=s[0],E=C[c]||null,A=i.id;return{idRol:E,idUsuario:A}}const e=JSON.parse(localStorage.getItem("user")),t=(l=e==null?void 0:e.roles)==null?void 0:l[0],o=C[t]||null,r=e==null?void 0:e.id;return{idRol:o,idUsuario:r}},[b,n]=d.useState([]),[h,m]=d.useState(!0);d.useEffect(()=>{(async()=>{m(!0);try{const{idRol:t,idUsuario:o}=u();if(!t){g.error("No se pudo determinar el rol del usuario."),n([]);return}let r=[];(t===2||t===9)&&o?r=await M(o):r=await _(),r=[...r].sort((l,c)=>new Date(c.fechaCreacion)-new Date(l.fechaCreacion)),n(r)}catch(t){g.error("Error al cargar clientes: "+(t.message??t)),n([])}finally{m(!1)}})()},[s,i]);const y=e=>{f(`/clientes/editar/${e.idCliente}`)},{idRol:j}=u(),w=j===2?"Mis Clientes":"Lista de Clientes",N=[{key:"idCliente",label:"",render:e=>a.jsxs("div",{className:"flex items-center justify-center group relative text-gray-500",children:[a.jsx(p,{className:"w-5 h-5"}),a.jsxs("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 text-xs text-white bg-zinc-800 px-2 py-0.5 rounded shadow opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-50 whitespace-nowrap",children:["ID: ",e]})]})},{key:"numeroDocumento",label:"Documento"},{key:"nombres",label:"Nombres"},{key:"apellidoPaterno",label:"Apellido Paterno"},{key:"apellidoMaterno",label:"Apellido Materno"},{key:"correoElectronico",label:"Correo"},{key:"telefonoCelular",label:"Celular"},{key:"fechaCreacion",label:"Fecha Creación",render:e=>e?new Date(e).toLocaleDateString("es-EC",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}];return a.jsxs("div",{className:"p-4 sm:p-6 md:p-8 max-w-full relative",children:[a.jsx(k,{visible:h,message:"Cargando clientes..."}),a.jsxs(v,{className:"w-full border border-muted rounded-xl shadow-[0_4px_10px_rgba(0,0,0,0.12)]",children:[a.jsx(D,{children:a.jsxs(U,{className:"text-3xl flex items-center gap-3",children:[a.jsx(p,{className:"text-blue-700"})," ",w]})}),a.jsx(P,{className:"p-6 overflow-x-auto",children:a.jsx(G,{columns:N,data:b,mostrarEditar:!0,mostrarEliminar:!1,mostrarAgregarNuevo:!1,onEditarClick:y})})]})]})}export{z as default};
