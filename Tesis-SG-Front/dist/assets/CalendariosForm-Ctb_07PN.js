import{c as j,r as C,j as o,G as y,I as g,B as f,t as h,g as P,L as N}from"./index-ABbIRX4x.js";import{u as w,c as I}from"./CalendarioOperacionesService-Pd8v99_L.js";function A({onClose:c,onSaved:l,initialData:e}){const{user:n}=j(),[b,p]=C.useState(!1),[r,v]=C.useState({nombre:"",fechaCorte:e!=null&&e.fechaCorte?e.fechaCorte.split("T")[0]:"",calendarioInversiones:e!=null&&e.calendarioInversiones?e.calendarioInversiones.toString():"1",fechaGenerarPagos:e!=null&&e.fechaGenerarPagos?e.fechaGenerarPagos.split("T")[0]:"",fechaEnvioEECC:e!=null&&e.fechaEnvioEECC?e.fechaEnvioEECC.split("T")[0]:"",estadoProcesoPagos:(e==null?void 0:e.estadoProcesoPagos)||!1,estadoProcesoEnvioEECC:(e==null?void 0:e.estadoProcesoEnvioEECC)||!1,estadoCalendario:(e==null?void 0:e.estadoCalendario)||!1,...e}),d=(s,a)=>v(x=>({...x,[s]:a})),E=async s=>{s.preventDefault(),p(!0);try{const a={...r,fechaCorte:r.fechaCorte?new Date(r.fechaCorte).toISOString():null,fechaGenerarPagos:r.fechaGenerarPagos?new Date(r.fechaGenerarPagos).toISOString():null,fechaEnvioEECC:r.fechaEnvioEECC?new Date(r.fechaEnvioEECC).toISOString():null,idUsuarioCreacion:n==null?void 0:n.id,idUsuarioPropietario:n==null?void 0:n.id};e!=null&&e.idCalendario?(await w(e.idCalendario,a),h.success("Calendario actualizado correctamente")):(await I(a),h.success("Calendario creado correctamente")),l==null||l(),c==null||c()}catch(a){h.error(`Error al ${e?"actualizar":"crear"} calendario: ${a.message??a}`)}finally{p(!1)}},t=({value:s,onChange:a,label:x})=>o.jsx(u,{label:x,children:o.jsxs("div",{className:"relative",children:[o.jsx(g,{type:"date",value:s,onChange:a,className:"pr-10",required:!0}),o.jsx(P,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none w-5 h-5"})]})});return o.jsxs("div",{className:"relative px-2 py-3 md:px-8 md:py-8",children:[o.jsx(y,{visible:b,message:e?"Actualizando calendario...":"Creando calendario..."}),o.jsxs("form",{onSubmit:E,className:"space-y-8 max-w-xl mx-auto",autoComplete:"off",children:[o.jsxs("section",{className:"bg-white rounded-2xl border border-gray-300 px-7 py-5 flex flex-col gap-4 shadow-lg transition-colors",children:[o.jsx("h3",{className:"font-semibold text-lg text-blue-900 mb-3 border-b pb-2",children:"Datos Generales"}),o.jsx(u,{label:"Nombre del Calendario",children:o.jsx(g,{placeholder:"Ej: 01 JUNIO 2026",value:r.nombre,onChange:s=>d("nombre",s.target.value),required:!0})}),o.jsx(u,{label:"Corte de las Inversiones",children:o.jsxs("select",{className:"w-full border rounded-md p-2 bg-white text-sm",value:r.calendarioInversiones,onChange:s=>d("calendarioInversiones",s.target.value),required:!0,children:[o.jsx("option",{value:"1",children:"1"}),o.jsx("option",{value:"10",children:"10"}),o.jsx("option",{value:"20",children:"20"})]})})]}),o.jsxs("section",{className:"bg-white rounded-2xl border border-gray-300 px-7 py-5 flex flex-col gap-4 shadow-lg transition-colors",children:[o.jsx("h3",{className:"font-semibold text-lg text-blue-900 mb-3 border-b pb-2",children:"Fechas Clave"}),o.jsx(t,{value:r.fechaCorte,onChange:s=>d("fechaCorte",s.target.value),label:"Fecha de Corte"}),o.jsx(t,{value:r.fechaGenerarPagos,onChange:s=>d("fechaGenerarPagos",s.target.value),label:"Fecha para Generar Pagos"}),o.jsx(t,{value:r.fechaEnvioEECC,onChange:s=>d("fechaEnvioEECC",s.target.value),label:"Fecha para Envío de EECC"})]}),o.jsxs("section",{className:"bg-gray-50 rounded-2xl border border-gray-200 px-7 py-5 flex flex-col gap-4 shadow transition-colors",children:[o.jsx("h3",{className:"font-semibold text-lg text-blue-900 mb-3 border-b pb-2",children:"Estados"}),o.jsx(m,{label:"Proceso de Pagos",value:r.estadoProcesoPagos,textoActivo:"Completado",textoInactivo:"Pendiente"}),o.jsx(m,{label:"Envío de EECC",value:r.estadoProcesoEnvioEECC,textoActivo:"Completado",textoInactivo:"Pendiente"}),o.jsx(m,{label:"Estado del Calendario",value:r.estadoCalendario,textoActivo:"Cerrado",textoInactivo:"Abierto"})]}),o.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[o.jsx(f,{type:"button",variant:"outline",onClick:c,className:"px-6 py-2",children:"Cancelar"}),o.jsx(f,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2",children:e?"Actualizar Calendario":"Crear Calendario"})]})]})]})}function u({label:c,children:l}){return o.jsxs("div",{className:"space-y-1.5",children:[o.jsx(N,{className:"font-medium text-gray-700 text-sm",children:c}),l]})}function m({label:c,value:l,textoActivo:e,textoInactivo:n}){return o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsx("span",{className:"font-medium text-gray-700",children:c}),o.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${l?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:l?e:n})]})}export{A as default};
