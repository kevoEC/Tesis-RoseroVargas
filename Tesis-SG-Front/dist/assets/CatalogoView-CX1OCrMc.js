import{r as l,a4 as H,Z as ie,j as e,a5 as ce,D as le,a6 as de,z as B,_ as V,H as y,a7 as G,a8 as K,a9 as ue,aa as pe,ab as he,ac as ge,ad as fe,ae as xe,af as ve,ag as me,ah as Ce,X as be,u as je,C as Pe,a as we,B as x,ai as Ne,I as M,aj as z,ak as ye,al as Re,am as Ae}from"./index-CG6H-kfp.js";import{T as Oe,f as Ee,g as I,h as L,i as Se,j as $,D as _e,a as De,b as ke,c as Fe,e as Te,E as Me,k as ze}from"./dialog-2_FlWSQy.js";var D="Popover",[U,ro]=le(D,[H]),R=H(),[Ie,m]=U(D),q=o=>{const{__scopePopover:s,children:t,open:n,defaultOpen:r,onOpenChange:a,modal:i=!1}=o,d=R(s),p=l.useRef(null),[h,v]=l.useState(!1),[w=!1,f]=ie({prop:n,defaultProp:r,onChange:a});return e.jsx(ce,{...d,children:e.jsx(Ie,{scope:s,contentId:de(),triggerRef:p,open:w,onOpenChange:f,onOpenToggle:l.useCallback(()=>f(N=>!N),[f]),hasCustomAnchor:h,onCustomAnchorAdd:l.useCallback(()=>v(!0),[]),onCustomAnchorRemove:l.useCallback(()=>v(!1),[]),modal:i,children:t})})};q.displayName=D;var Z="PopoverAnchor",Le=l.forwardRef((o,s)=>{const{__scopePopover:t,...n}=o,r=m(Z,t),a=R(t),{onCustomAnchorAdd:i,onCustomAnchorRemove:d}=r;return l.useEffect(()=>(i(),()=>d()),[i,d]),e.jsx(G,{...a,...n,ref:s})});Le.displayName=Z;var W="PopoverTrigger",X=l.forwardRef((o,s)=>{const{__scopePopover:t,...n}=o,r=m(W,t),a=R(t),i=B(s,r.triggerRef),d=e.jsx(V.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":oe(r.open),...n,ref:i,onClick:y(o.onClick,r.onOpenToggle)});return r.hasCustomAnchor?d:e.jsx(G,{asChild:!0,...a,children:d})});X.displayName=W;var k="PopoverPortal",[$e,He]=U(k,{forceMount:void 0}),J=o=>{const{__scopePopover:s,forceMount:t,children:n,container:r}=o,a=m(k,s);return e.jsx($e,{scope:s,forceMount:t,children:e.jsx(K,{present:t||a.open,children:e.jsx(ue,{asChild:!0,container:r,children:n})})})};J.displayName=k;var P="PopoverContent",Q=l.forwardRef((o,s)=>{const t=He(P,o.__scopePopover),{forceMount:n=t.forceMount,...r}=o,a=m(P,o.__scopePopover);return e.jsx(K,{present:n||a.open,children:a.modal?e.jsx(Ve,{...r,ref:s}):e.jsx(Ge,{...r,ref:s})})});Q.displayName=P;var Be=ge("PopoverContent.RemoveScroll"),Ve=l.forwardRef((o,s)=>{const t=m(P,o.__scopePopover),n=l.useRef(null),r=B(s,n),a=l.useRef(!1);return l.useEffect(()=>{const i=n.current;if(i)return pe(i)},[]),e.jsx(he,{as:Be,allowPinchZoom:!0,children:e.jsx(Y,{...o,ref:r,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:y(o.onCloseAutoFocus,i=>{var d;i.preventDefault(),a.current||(d=t.triggerRef.current)==null||d.focus()}),onPointerDownOutside:y(o.onPointerDownOutside,i=>{const d=i.detail.originalEvent,p=d.button===0&&d.ctrlKey===!0,h=d.button===2||p;a.current=h},{checkForDefaultPrevented:!1}),onFocusOutside:y(o.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Ge=l.forwardRef((o,s)=>{const t=m(P,o.__scopePopover),n=l.useRef(!1),r=l.useRef(!1);return e.jsx(Y,{...o,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var i,d;(i=o.onCloseAutoFocus)==null||i.call(o,a),a.defaultPrevented||(n.current||(d=t.triggerRef.current)==null||d.focus(),a.preventDefault()),n.current=!1,r.current=!1},onInteractOutside:a=>{var p,h;(p=o.onInteractOutside)==null||p.call(o,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const i=a.target;((h=t.triggerRef.current)==null?void 0:h.contains(i))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&r.current&&a.preventDefault()}})}),Y=l.forwardRef((o,s)=>{const{__scopePopover:t,trapFocus:n,onOpenAutoFocus:r,onCloseAutoFocus:a,disableOutsidePointerEvents:i,onEscapeKeyDown:d,onPointerDownOutside:p,onFocusOutside:h,onInteractOutside:v,...w}=o,f=m(P,t),N=R(t);return fe(),e.jsx(xe,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:r,onUnmountAutoFocus:a,children:e.jsx(ve,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:v,onEscapeKeyDown:d,onPointerDownOutside:p,onFocusOutside:h,onDismiss:()=>f.onOpenChange(!1),children:e.jsx(me,{"data-state":oe(f.open),role:"dialog",id:f.contentId,...N,...w,ref:s,style:{...w.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ee="PopoverClose",Ke=l.forwardRef((o,s)=>{const{__scopePopover:t,...n}=o,r=m(ee,t);return e.jsx(V.button,{type:"button",...n,ref:s,onClick:y(o.onClick,()=>r.onOpenChange(!1))})});Ke.displayName=ee;var Ue="PopoverArrow",qe=l.forwardRef((o,s)=>{const{__scopePopover:t,...n}=o,r=R(t);return e.jsx(Ce,{...r,...n,ref:s})});qe.displayName=Ue;function oe(o){return o?"open":"closed"}var Ze=q,We=X,Xe=J,Je=Q;function Qe({...o}){return e.jsx(Ze,{"data-slot":"popover",...o})}function Ye({...o}){return e.jsx(We,{"data-slot":"popover-trigger",...o})}function eo({className:o,align:s="center",sideOffset:t=4,...n}){return e.jsx(Xe,{children:e.jsx(Je,{"data-slot":"popover-content",align:s,sideOffset:t,className:be("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",o),...n})})}function ao({titulo:o,entidad:s,columnas:t,data:n,onEditar:r,onEliminar:a}){const[i,d]=l.useState(""),[p,h]=l.useState(1),[v,w]=l.useState(10),[f,N]=l.useState({}),[F,A]=l.useState({open:!1,item:null}),te=je(),O=Object.keys(t);let j=n.filter(c=>Object.values(c).some(u=>u==null?void 0:u.toString().toLowerCase().includes(i.toLowerCase())));j=j.filter(c=>Object.entries(f).every(([u,g])=>{var C;return g?(C=c[u])==null?void 0:C.toString().toLowerCase().includes(g.toLowerCase()):!0}));const E=Math.ceil(j.length/v),T=(p-1)*v,re=j.slice(T,T+v),ae=(c,u,g="export.csv")=>{const C=[u.join(","),...c.map(_=>u.map(ne=>`"${(_[ne]??"").toString().replace(/"/g,'""')}"`).join(","))].join(`
`),S=new Blob([C],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a");b.href=URL.createObjectURL(S),b.setAttribute("download",g),document.body.appendChild(b),b.click(),document.body.removeChild(b)},se=(c,u,g="export.pdf")=>{const C=new Me,S=c.map(b=>u.map(_=>b[_]??""));ze(C,{head:[u],body:S,styles:{fontSize:8},headStyles:{fillColor:[41,128,185]},margin:{top:20}}),C.save(g)};return e.jsx(Pe,{className:"bg-white border border-[--color-border] shadow-lg rounded-2xl fade-in-up",children:e.jsxs(we,{className:"py-6 px-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:o}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsxs(x,{onClick:()=>te(`/${s}/nuevo`),className:"bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-lg",children:[e.jsx(Ne,{size:16,className:"mr-2"})," Nuevo"]}),e.jsx(M,{placeholder:"Buscar...",value:i,onChange:c=>d(c.target.value),className:"h-10 text-sm bg-white border border-gray-300 shadow-sm w-52"}),e.jsxs(x,{variant:"outline",className:"text-sm bg-white border border-gray-300 shadow-sm",onClick:()=>ae(j,O),children:[e.jsx(z,{size:16,className:"mr-2"})," Exportar CSV"]}),e.jsxs(x,{variant:"outline",className:"text-sm bg-white border border-gray-300 shadow-sm",onClick:()=>se(j,O),children:[e.jsx(z,{size:16,className:"mr-2"})," Exportar PDF"]})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs(Oe,{children:[e.jsx(Ee,{className:"bg-gray-50 text-gray-700",children:e.jsxs(I,{children:[O.map(c=>e.jsx(L,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[t[c],e.jsxs(Qe,{children:[e.jsx(Ye,{asChild:!0,children:e.jsx(x,{size:"icon",variant:"ghost",className:"w-5 h-5 p-0",children:e.jsx(ye,{size:14})})}),e.jsx(eo,{className:"bg-white w-48 p-4 border border-gray-200 shadow-lg",children:e.jsx(M,{placeholder:`Filtrar ${c}`,value:f[c]||"",onChange:u=>N(g=>({...g,[c]:u.target.value})),className:"h-8 text-sm"})})]})]})},c)),e.jsx(L,{className:"text-right",children:"Acciones"})]})}),e.jsx(Se,{children:re.map((c,u)=>e.jsxs(I,{className:"hover:bg-gray-50 transition",children:[O.map(g=>e.jsx($,{children:c[g]},g)),e.jsxs($,{className:"flex justify-end gap-2 py-3",children:[e.jsx(x,{variant:"outline",onClick:()=>r(c),className:"text-sm",children:"Editar"}),e.jsx(x,{size:"sm",variant:"destructive",onClick:()=>A({open:!0,item:c}),className:"text-sm bg-red-600 hover:bg-red-700 text-white",children:"Eliminar"})]})]},u))})]})}),e.jsxs("div",{className:"flex justify-center items-center gap-4 pt-4 pb-4",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>h(c=>Math.max(c-1,1)),disabled:p===1,className:"rounded-full border border-gray-300 hover:bg-gray-100 disabled:opacity-50",children:e.jsx(Re,{size:18})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Página ",p," de ",E]}),e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>h(c=>Math.min(c+1,E)),disabled:p===E,className:"rounded-full border border-gray-300 hover:bg-gray-100 disabled:opacity-50",children:e.jsx(Ae,{size:18})})]}),e.jsx(_e,{open:F.open,onOpenChange:c=>A(u=>({...u,open:c})),children:e.jsxs(De,{className:"bg-white rounded-lg shadow-xl border border-gray-200",children:[e.jsx(ke,{children:e.jsx(Fe,{children:"¿Estás seguro de eliminar este elemento?"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Esta acción no se puede deshacer."}),e.jsxs(Te,{children:[e.jsx(x,{variant:"outline",onClick:()=>A({open:!1,item:null}),children:"Cancelar"}),e.jsx(x,{variant:"destructive",onClick:()=>{a(F.item),A({open:!1,item:null})},className:"bg-red-600 hover:bg-red-700 text-white",children:"Eliminar"})]})]})})]})})}export{ao as C};
