import{f as E,r as g,j as e,G as y,I as d,B as A,g as O,h as T,t as f,L as G}from"./index-CG6H-kfp.js";import{S as h,a as p,b as m,c as x,d as j}from"./select-B3dX9JJ0.js";import{c as M}from"./ProspectoService-CHx1iZIb.js";import{g as q}from"./ProductoInteresService-uZkqrmTw.js";import{g as L}from"./OrigenClienteService-Hn7RdPN2.js";import{g as V}from"./TipoIdentificacionService-DqUkVc03.js";import"./index-DMmKv1VD.js";function R({onClose:t,onSaved:c}){const{user:a}=E(),[n,C]=g.useState({nombres:"",apellidoPaterno:"",apellidoMaterno:"",correoElectronico:"",telefonoCelular:"",idTipoIdentificacion:"",idOrigenCliente:"",idProductoInteres:"",idAgencia:""}),[I,b]=g.useState(!1),[u,S]=g.useState({tipoIdentificaciones:[],origenes:[],productos:[],agencias:[]});g.useEffect(()=>{(async()=>{try{const[l,s,N,w]=await Promise.all([T(),q(),L(),V()]);S({agencias:l,productos:s,origenes:N,tipoIdentificaciones:w})}catch{f.error("No se pudieron cargar los catálogos")}})()},[]);const o=(r,l)=>{C(s=>({...s,[r]:l}))},v=r=>{const s=r.replace(/\D/g,"").slice(0,10).replace(/(\d{3})(\d{3})(\d{0,4})/,"$1-$2-$3");o("telefonoCelular",s)},P=async r=>{r.preventDefault();const l={...n,estado:!0,idSolicitudInversion:null,fechaCreacion:new Date().toISOString(),fechaModificacion:new Date().toISOString(),idUsuarioCreacion:(a==null?void 0:a.id)||null,idUsuarioModificacion:(a==null?void 0:a.id)||null,idUsuarioPropietario:(a==null?void 0:a.id)||null,esCliente:!1};b(!0);try{await M(l),f.success("Prospecto guardado correctamente"),c==null||c(),t==null||t()}catch{f.error("Error al guardar prospecto")}finally{b(!1)}};return e.jsxs("div",{className:"p-4 relative",children:[e.jsx(y,{visible:I,message:"Guardando prospecto..."}),e.jsx("div",{className:"bg-white p-6 rounded-2xl border border-gray-200 shadow-md",children:e.jsxs("form",{onSubmit:P,className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(i,{label:"Nombres",children:e.jsx(d,{placeholder:"Ej: Juan Andrés",value:n.nombres,onChange:r=>o("nombres",r.target.value),required:!0})}),e.jsx(i,{label:"Apellido Paterno",children:e.jsx(d,{placeholder:"Ej: Pérez",value:n.apellidoPaterno,onChange:r=>o("apellidoPaterno",r.target.value),required:!0})}),e.jsx(i,{label:"Apellido Materno",children:e.jsx(d,{placeholder:"Ej: Gutiérrez",value:n.apellidoMaterno,onChange:r=>o("apellidoMaterno",r.target.value),required:!0})}),e.jsx(i,{label:"Correo Electrónico",children:e.jsx(d,{type:"email",placeholder:"Ej: ejemplo@correo.com",value:n.correoElectronico,onChange:r=>o("correoElectronico",r.target.value),required:!0})}),e.jsx(i,{label:"Teléfono Celular",children:e.jsx(d,{placeholder:"Ej: 099-123-4567",value:n.telefonoCelular,onChange:r=>v(r.target.value),maxLength:12,required:!0})}),e.jsx(i,{label:"Tipo de Identificación",children:e.jsxs(h,{onValueChange:r=>o("idTipoIdentificacion",Number(r)),children:[e.jsx(p,{children:e.jsx(m,{placeholder:"Seleccionar..."})}),e.jsx(x,{className:"bg-white",children:u.tipoIdentificaciones.map(r=>e.jsx(j,{value:r.idTipoIdentificacion.toString(),children:r.tipo},r.idTipoIdentificacion))})]})}),e.jsx(i,{label:"Origen del Cliente",children:e.jsxs(h,{onValueChange:r=>o("idOrigenCliente",Number(r)),children:[e.jsx(p,{children:e.jsx(m,{placeholder:"Seleccionar..."})}),e.jsx(x,{className:"bg-white",children:u.origenes.map(r=>e.jsx(j,{value:r.idOrigenCliente.toString(),children:r.nombreOrigen},r.idOrigenCliente))})]})}),e.jsx(i,{label:"Producto de Interés",children:e.jsxs(h,{onValueChange:r=>o("idProductoInteres",Number(r)),children:[e.jsx(p,{children:e.jsx(m,{placeholder:"Seleccionar..."})}),e.jsx(x,{className:"bg-white",children:u.productos.map(r=>e.jsx(j,{value:r.idProductoInteres.toString(),children:r.nombre},r.idProductoInteres))})]})}),e.jsx(i,{label:"Agencia",children:e.jsxs(h,{onValueChange:r=>o("idAgencia",Number(r)),children:[e.jsx(p,{children:e.jsx(m,{placeholder:"Seleccionar..."})}),e.jsx(x,{className:"bg-white",children:u.agencias.map(r=>e.jsx(j,{value:r.idAgencia.toString(),children:r.ciudad},r.idAgencia))})]})}),e.jsx("div",{className:"col-span-full",children:e.jsxs(A,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg",children:[e.jsx(O,{className:"w-4 h-4 mr-2"})," Guardar Prospecto"]})})]})})]})}function i({label:t,children:c}){return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(G,{className:"font-medium text-gray-700 text-sm",children:t}),c]})}export{R as default};
