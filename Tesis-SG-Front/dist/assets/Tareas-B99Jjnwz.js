import{u as E,c as w,r as l,j as a,G as T,C as N,d as R,e as A,a as k,t as d}from"./index-ABbIRX4x.js";import{T as L}from"./TablaCustom2-DS7_i3Ng.js";import{g as v}from"./TareaService-8EzhbblL.js";import"./jspdf.plugin.autotable-CZR7NrjE.js";const S={Administrador:1,"Asesor Comercial":2,"Asesor Legal":3,"Analista de riesgos":4,"Analista de emisión":5,"Analista financiero":6,"Gerencia Comercial":7,Gerencia:8,Externo:9},c={5:"Bandeja de Emisiones",3:"Bandeja de Legal",6:"Bandeja Financiera",7:"Bandeja Comercial",4:"Bandeja de Riesgos",externo:"Carga de comprobante de abono",comercial:"Solicitar comprobante de abono"};function _(){const g=E(),{roles:s,user:u}=w(),[p,b]=l.useState([]),[h,x]=l.useState(!0),f=l.useRef(!1),r=(s==null?void 0:s[0])||"",i=S[r]||null;let n="Lista de Tareas";r==="Externo"?n=c.externo:r==="Asesor Comercial"?n=c.comercial:c[i]&&(n=c[i]),l.useEffect(()=>{(async()=>{x(!0);try{if(!i){d.error("No se pudo determinar el rol del usuario.");return}let t=[...await v(i)];(r==="Externo"||r==="Asesor Comercial")&&(t=t.filter(o=>o.idUsuarioCreacion===u.id),!f.current&&t.some(o=>o.nombreResultado==="Pendiente")&&(r==="Externo"?d.info("Recuerda realizar el depósito del capital para continuar con la solicitud."):r==="Asesor Comercial"&&d.info("Recuerda solicitar al Cliente el comprobante de abono del capital."),f.current=!0)),t.sort((o,j)=>new Date(j.fechaCreacion)-new Date(o.fechaCreacion)),b(t)}catch(m){d.error("Error al cargar tareas: "+(m.message??m))}finally{x(!1)}})()},[s,u]);const y=e=>{g(`/tareas/editar/${e.idTarea}`)},C=[{key:"idTarea",label:"",render:e=>a.jsxs("div",{className:"flex items-center justify-center group relative text-gray-500",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17h6m-6-4h6m2 9a2 2 0 002-2V7a2 2 0 00-2-2h-3.586a1 1 0 01-.707-.293l-1.414-1.414A1 1 0 0011.586 3H9a2 2 0 00-2 2v14a2 2 0 002 2h6z"})}),a.jsxs("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 text-xs text-white bg-zinc-800 px-2 py-0.5 rounded shadow opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-50 whitespace-nowrap",children:["ID: ",e]})]})},{key:"nombreTipoTarea",label:"Tipo de Tarea",render:e=>a.jsx("span",{className:"px-3 py-1 text-xs font-bold rounded-full bg-blue-100 text-blue-700 border border-blue-300 shadow-sm",children:e})},{key:"tareaNombre",label:"Nombre"},{key:"nombreResultado",label:"Resultado",render:e=>a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${e==="Pendiente"?"bg-yellow-100 text-yellow-700":e==="Aprobado"?"bg-green-100 text-green-700":e==="Rechazado"?"bg-red-100 text-red-700":"bg-gray-200 text-gray-700"}`,children:e})},{key:"fechaCreacion",label:"Creación",render:e=>e?new Date(e).toLocaleDateString("es-EC",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""},{key:"fechaModificacion",label:"Modificación",render:e=>e?new Date(e).toLocaleDateString("es-EC",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):a.jsx("span",{className:"text-gray-400 italic",children:"Sin modificación"})}];return a.jsxs("div",{className:"p-4 sm:p-6 md:p-8 max-w-full relative",children:[a.jsx(T,{visible:h,message:"Cargando tareas..."}),a.jsxs(N,{className:"w-full border border-muted rounded-xl shadow-[0_4px_10px_rgba(0,0,0,0.12)]",children:[a.jsx(R,{children:a.jsx(A,{className:"text-3xl font-bold text-gray-900 flex items-center",children:n})}),a.jsx(k,{className:"p-6 overflow-x-auto",children:a.jsx(L,{columns:C,data:p,mostrarEditar:!0,mostrarEliminar:!0,mostrarAgregarNuevo:!1,onEditarClick:y,onEliminarClick:e=>console.log("Eliminar:",e)})})]})]})}export{_ as default};
