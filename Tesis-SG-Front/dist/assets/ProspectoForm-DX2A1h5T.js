import{c as E,r as g,j as e,G as A,I as d,B as C,i as O,k as q,t as p,L as T}from"./index-ABbIRX4x.js";import{S as h,a as m,b as x,c as j,d as f}from"./select-C75wXMdb.js";import{c as L}from"./ProspectoService-DqbVOVKq.js";import{g as G}from"./ProductoInteresService-DsF71vH2.js";import{g as M}from"./OrigenClienteService-DdBWUzxM.js";import{g as D}from"./TipoIdentificacionService-BJmrDHaB.js";import"./index-CFqNEq9z.js";function J({onClose:n,onSaved:c}){const{user:o}=E(),[a,v]=g.useState({nombres:"",apellidoPaterno:"",apellidoMaterno:"",correoElectronico:"",telefonoCelular:"",idTipoIdentificacion:"",idOrigenCliente:"",idProductoInteres:"",idAgencia:""}),[I,b]=g.useState(!1),[u,P]=g.useState({tipoIdentificaciones:[],origenes:[],productos:[],agencias:[]});g.useEffect(()=>{(async()=>{try{const[l,s,y,w]=await Promise.all([q(),G(),M(),D()]);P({agencias:l,productos:s,origenes:y,tipoIdentificaciones:w})}catch{p.error("No se pudieron cargar los catálogos")}})()},[]);const i=(r,l)=>{v(s=>({...s,[r]:l}))},N=r=>{const s=r.replace(/\D/g,"").slice(0,10).replace(/(\d{3})(\d{3})(\d{0,4})/,"$1-$2-$3");i("telefonoCelular",s)},S=async r=>{if(r.preventDefault(),!a.nombres.trim()||!a.apellidoPaterno.trim()||!a.correoElectronico.trim()||!a.telefonoCelular.trim()||!a.idTipoIdentificacion||!a.idOrigenCliente||!a.idProductoInteres||!a.idAgencia){p.error("Completa todos los campos obligatorios.");return}const l={...a,estado:!0,idSolicitudInversion:null,fechaCreacion:new Date().toISOString(),fechaModificacion:new Date().toISOString(),idUsuarioCreacion:(o==null?void 0:o.id)??null,idUsuarioModificacion:(o==null?void 0:o.id)??null,idUsuarioPropietario:(o==null?void 0:o.id)??null,esCliente:!1};b(!0);try{await L(l),p.success("Prospecto guardado correctamente"),c==null||c(),n==null||n()}catch{p.error("Error al guardar prospecto")}finally{b(!1)}};return e.jsxs("div",{className:"relative px-2 py-3 md:px-7 md:py-7",children:[e.jsx(A,{visible:I,message:"Guardando prospecto..."}),e.jsxs("form",{onSubmit:S,className:"space-y-8 max-w-2xl mx-auto",autoComplete:"off",children:[e.jsxs("section",{className:"bg-white rounded-2xl border border-gray-200 px-7 py-5 flex flex-col gap-4 shadow-lg transition-colors",children:[e.jsx("h3",{className:"font-semibold text-lg text-violet-700 mb-3 border-b pb-2",children:"Datos del Prospecto"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsx(t,{label:"Nombres",children:e.jsx(d,{placeholder:"Ej: Juan Andrés",value:a.nombres,maxLength:60,onChange:r=>i("nombres",r.target.value),required:!0})}),e.jsx(t,{label:"Apellido Paterno",children:e.jsx(d,{placeholder:"Ej: Pérez",value:a.apellidoPaterno,maxLength:30,onChange:r=>i("apellidoPaterno",r.target.value),required:!0})}),e.jsx(t,{label:"Apellido Materno",children:e.jsx(d,{placeholder:"Ej: Gutiérrez",value:a.apellidoMaterno,maxLength:30,onChange:r=>i("apellidoMaterno",r.target.value),required:!0})}),e.jsx(t,{label:"Correo Electrónico",children:e.jsx(d,{type:"email",placeholder:"Ej: ejemplo@correo.com",value:a.correoElectronico,onChange:r=>i("correoElectronico",r.target.value),required:!0})}),e.jsx(t,{label:"Teléfono Celular",children:e.jsx(d,{placeholder:"Ej: 099-123-4567",value:a.telefonoCelular,onChange:r=>N(r.target.value),maxLength:12,required:!0})}),e.jsx(t,{label:"Tipo de Identificación",children:e.jsxs(h,{required:!0,onValueChange:r=>i("idTipoIdentificacion",Number(r)),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Seleccionar..."})}),e.jsx(j,{className:"bg-white",children:u.tipoIdentificaciones.map(r=>e.jsx(f,{value:r.idTipoIdentificacion.toString(),children:r.tipo},r.idTipoIdentificacion))})]})}),e.jsx(t,{label:"Origen del Cliente",children:e.jsxs(h,{required:!0,onValueChange:r=>i("idOrigenCliente",Number(r)),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Seleccionar..."})}),e.jsx(j,{className:"bg-white",children:u.origenes.map(r=>e.jsx(f,{value:r.idOrigenCliente.toString(),children:r.nombreOrigen},r.idOrigenCliente))})]})}),e.jsx(t,{label:"Producto de Interés",children:e.jsxs(h,{required:!0,onValueChange:r=>i("idProductoInteres",Number(r)),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Seleccionar..."})}),e.jsx(j,{className:"bg-white",children:u.productos.map(r=>e.jsx(f,{value:r.idProductoInteres.toString(),children:r.nombre},r.idProductoInteres))})]})}),e.jsx(t,{label:"Agencia",children:e.jsxs(h,{required:!0,onValueChange:r=>i("idAgencia",Number(r)),children:[e.jsx(m,{children:e.jsx(x,{placeholder:"Seleccionar..."})}),e.jsx(j,{className:"bg-white",children:u.agencias.map(r=>e.jsx(f,{value:r.idAgencia.toString(),children:r.ciudad},r.idAgencia))})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx(C,{type:"button",variant:"outline",onClick:n,className:"px-6 py-2",children:"Cancelar"}),e.jsxs(C,{type:"submit",className:"bg-violet-600 hover:bg-violet-700 text-white px-6 py-2",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Guardar Prospecto"]})]})]})]})}function t({label:n,children:c}){return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(T,{className:"font-medium text-gray-700 text-sm",children:n}),c]})}export{J as default};
