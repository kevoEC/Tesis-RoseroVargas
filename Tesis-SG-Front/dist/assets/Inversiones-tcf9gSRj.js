import{u as g,c as h,r,j as a,G as v,C as y,d as C,e as j,a as N,t as o}from"./index-ABbIRX4x.js";import{F as l,T as E}from"./TablaCustom2-DS7_i3Ng.js";import{g as w}from"./InversionService-CD1AeE6A.js";import"./jspdf.plugin.autotable-CZR7NrjE.js";function z(){const d=g(),{roles:s=[],user:t={}}=h(),[c,u]=r.useState([]),[m,n]=r.useState(!0),i=r.useRef(!1),x=async()=>{n(!0);try{let e=await w();(s.includes("Externo")||s.includes("Asesor Comercial"))&&(e=(e||[]).filter(b=>b.idUsuarioPropietario===t.id)),s.includes("Externo")&&(!e||e.length===0)&&!i.current&&(o.info("Una inversión es creada cuando completes el proceso de solicitud de inversión."),i.current=!0),u(Array.isArray(e)?e:[])}catch(e){o.error("Error al cargar inversiones: "+(e.message??e))}finally{n(!1)}};r.useEffect(()=>{x()},[s,t]);const p=e=>{d(`/inversiones/editar/${e.idInversion}`)},f=[{key:"idInversion",label:"",render:e=>a.jsxs("div",{className:"flex items-center justify-center group relative text-gray-500",children:[a.jsx(l,{className:"w-5 h-5"}),a.jsxs("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 text-xs text-white bg-zinc-800 px-2 py-0.5 rounded shadow opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-50 whitespace-nowrap",children:["ID: ",e]})]})},{key:"inversionNombre",label:"Nombre"},{key:"nombreCompletoCliente",label:"Cliente"},{key:"capital",label:"Capital",render:e=>e!=null?`$${Number(e).toLocaleString("es-EC",{minimumFractionDigits:2})}`:"-"},{key:"plazo",label:"Plazo (meses)"},{key:"tasa",label:"Tasa",render:e=>e!=null?`${Number(e).toFixed(2)}%`:"-"},{key:"fechaCreacion",label:"Fecha Creación",render:e=>e?new Date(e).toLocaleDateString("es-EC"):""},{key:"terminada",label:"Estado",render:e=>e?a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-700",children:"Finalizada"}):a.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-700",children:"Vigente"})}];return a.jsxs("div",{className:"p-4 sm:p-6 md:p-8 max-w-full relative",children:[a.jsx(v,{visible:m,message:"Cargando inversiones..."}),a.jsxs(y,{className:"w-full border border-muted rounded-xl shadow-[0_4px_10px_rgba(0,0,0,0.12)]",children:[a.jsx(C,{children:a.jsxs(j,{className:"text-3xl flex items-center gap-3",children:[a.jsx(l,{className:"text-blue-700"})," Lista de Inversiones"]})}),a.jsx(N,{className:"p-6 overflow-x-auto",children:a.jsx(E,{columns:f,data:c,mostrarEditar:!0,mostrarEliminar:!1,mostrarAgregarNuevo:!1,onEditarClick:p})})]})]})}export{z as default};
