import{c as y,r as j,j as e,G as F,I as d,B as N,t as p,L as w}from"./index-ABbIRX4x.js";import{c as I}from"./ProductoService-HhWDSlJO.js";const M=[{idFormaPago:1,formaPagoNombre:"No Aplica"},{idFormaPago:2,formaPagoNombre:"Al finalizar"},{idFormaPago:3,formaPagoNombre:"Según su periodicidad"}];function L({onClose:t,onSaved:c,initialData:g}){const{user:m}=y(),[v,u]=j.useState(!1),[a,f]=j.useState({productoNombre:"",nombreComercial:"",productoCodigo:"",iniciales:"",descripcion:"",idFormaPago:"",periocidad:"",montoMinimoIncremento:"",penalidad:"",...g}),i=(r,s)=>f(n=>({...n,[r]:s})),C=async r=>{var s,n,x,b,h;r.preventDefault(),u(!0);try{const o={productoNombre:(s=a.productoNombre)==null?void 0:s.trim(),nombreComercial:(n=a.nombreComercial)==null?void 0:n.trim(),productoCodigo:(x=a.productoCodigo)==null?void 0:x.trim(),iniciales:(b=a.iniciales)==null?void 0:b.trim(),descripcion:(h=a.descripcion)==null?void 0:h.trim(),idFormaPago:Number(a.idFormaPago),periocidad:Number(a.periocidad),montoMinimoIncremento:Number(a.montoMinimoIncremento),penalidad:Number(a.penalidad),idUsuarioCreacion:m==null?void 0:m.id,fechaCreacion:new Date().toISOString()};if(!o.productoNombre||!o.nombreComercial||!o.productoCodigo||!o.iniciales||!o.descripcion||!o.idFormaPago||isNaN(o.periocidad)||isNaN(o.montoMinimoIncremento)||isNaN(o.penalidad)){p.error("Completa todos los campos obligatorios."),u(!1);return}await I(o),p.success("Producto creado correctamente"),c==null||c(),t==null||t()}catch(o){p.error(`Error al crear producto: ${o.message??o}`)}finally{u(!1)}},P=[{value:0,label:"Al finalizar"},{value:1,label:"Mensual"},{value:2,label:"Bimensual"},{value:3,label:"Trimestral"},{value:6,label:"Semestral"}];return e.jsxs("div",{className:"relative px-2 py-3 md:px-7 md:py-7",children:[e.jsx(F,{visible:v,message:"Guardando producto..."}),e.jsxs("form",{onSubmit:C,className:"space-y-8 max-w-xl mx-auto",autoComplete:"off",children:[e.jsxs("section",{className:"bg-white rounded-2xl border border-gray-300 px-7 py-5 flex flex-col gap-4 shadow-lg transition-colors",children:[e.jsx("h3",{className:"font-semibold text-lg text-blue-900 mb-3 border-b pb-2",children:"Datos del Producto"}),e.jsx(l,{label:"Nombre del Producto",children:e.jsx(d,{type:"text",value:a.productoNombre,maxLength:50,onChange:r=>i("productoNombre",r.target.value),required:!0,placeholder:"Ej: Renta Fija"})}),e.jsx(l,{label:"Nombre Comercial",children:e.jsx(d,{type:"text",value:a.nombreComercial,maxLength:80,onChange:r=>i("nombreComercial",r.target.value),required:!0,placeholder:"Ej: Fondo de renta fija"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(l,{label:"Código",children:e.jsx(d,{type:"text",value:a.productoCodigo,maxLength:10,onChange:r=>i("productoCodigo",r.target.value),required:!0,placeholder:"Ej: RF01"})}),e.jsx(l,{label:"Iniciales",children:e.jsx(d,{type:"text",value:a.iniciales,maxLength:6,onChange:r=>i("iniciales",r.target.value),required:!0,placeholder:"Ej: FRF"})}),e.jsx(l,{label:"Periodicidad",children:e.jsxs("select",{className:"w-full border rounded-md p-2 bg-white text-sm",value:a.periocidad,onChange:r=>i("periocidad",r.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar..."}),P.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(l,{label:"Forma de Pago",children:e.jsxs("select",{className:"w-full border rounded-md p-2 bg-white text-sm",value:a.idFormaPago,onChange:r=>i("idFormaPago",r.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar..."}),M.map(r=>e.jsx("option",{value:r.idFormaPago,children:r.formaPagoNombre},r.idFormaPago))]})}),e.jsx(l,{label:"Monto Mínimo Incremento",children:e.jsx(d,{type:"number",min:0,step:.01,value:a.montoMinimoIncremento,onChange:r=>i("montoMinimoIncremento",r.target.value),required:!0,placeholder:"Ej: 1000.00"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(l,{label:"Penalidad (%)",children:e.jsx(d,{type:"number",min:0,step:.01,value:a.penalidad,onChange:r=>i("penalidad",r.target.value),required:!0,placeholder:"Ej: 0.20"})}),e.jsx(l,{label:"Descripción",children:e.jsx("textarea",{className:"w-full border rounded-md p-2 bg-white text-sm",value:a.descripcion,maxLength:255,rows:3,onChange:r=>i("descripcion",r.target.value),required:!0,placeholder:"Breve descripción del producto"})})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx(N,{type:"button",variant:"outline",onClick:t,className:"px-6 py-2",children:"Cancelar"}),e.jsx(N,{type:"submit",className:"bg-amber-600 hover:bg-amber-700 text-white px-6 py-2",children:g?"Actualizar Producto":"Crear Producto"})]})]})]})}function l({label:t,children:c}){return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(w,{className:"font-medium text-gray-700 text-sm",children:t}),c]})}export{L as default};
