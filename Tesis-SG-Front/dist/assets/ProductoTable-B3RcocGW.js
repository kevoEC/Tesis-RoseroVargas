import{u as C,r as o,j as r,G as y,C as j,d as w,e as k,a as D,t as i}from"./index-ABbIRX4x.js";import{T as N}from"./TablaCustom2-DS7_i3Ng.js";import{D as P,a as v,b as E,c as S,d as T}from"./jspdf.plugin.autotable-CZR7NrjE.js";import{g as A,d as L}from"./ProductoService-HhWDSlJO.js";import z from"./ProductoForm-C0ZDPq9K.js";function B(){const c=C(),[n,d]=o.useState([]),[u,l]=o.useState(!0),[m,t]=o.useState(!1),s=async()=>{l(!0);try{const e=await A();d(e)}catch(e){i.error("Error al cargar productos: "+(e.message??e))}finally{l(!1)}};o.useEffect(()=>{s()},[]);const p=()=>t(!0),x=e=>{c(`/catalogo/producto/editar/${e.idProducto}`)},g=async e=>{if(window.confirm("¿Eliminar este producto?"))try{await L(e.idProducto),i.success("Producto eliminado."),s()}catch(a){i.error("Error al eliminar producto: "+(a.message??a))}},h={0:"Al finalizar",1:"Mensual",2:"Bimensual",3:"Trimestral",6:"Semestral"},f=[{key:"idProducto",label:"",render:e=>r.jsxs("div",{className:"flex items-center justify-center group relative text-zinc-500",children:[r.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"1.8",viewBox:"0 0 24 24",children:[r.jsx("rect",{x:"5",y:"5",width:"14",height:"14",rx:"2",stroke:"currentColor",strokeWidth:"1.8"}),r.jsx("circle",{cx:"12",cy:"12",r:"4",stroke:"currentColor",strokeWidth:"1.5"})]}),r.jsxs("span",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 text-xs text-white bg-zinc-800 px-2 py-0.5 rounded shadow opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-50 whitespace-nowrap",children:["ID: ",e]})]})},{key:"productoNombre",label:"Nombre"},{key:"nombreComercial",label:"Comercial"},{key:"productoCodigo",label:"Código"},{key:"iniciales",label:"Iniciales"},{key:"formaPagoNombre",label:"Forma de Pago"},{key:"periocidad",label:"Periodicidad",render:e=>h[e]??e},{key:"descripcion",label:"Descripción"},{key:"fechaCreacion",label:"Fecha Creación",render:e=>e?new Date(e).toLocaleDateString():""},{key:"usuarioCreacionNombre",label:"Creado por"}],b=[...n].sort((e,a)=>new Date(a.fechaCreacion)-new Date(e.fechaCreacion));return r.jsxs("div",{className:"p-4 sm:p-6 md:p-8 max-w-full relative",children:[r.jsx(y,{visible:u,message:"Cargando productos..."}),r.jsxs(j,{className:"w-full border border-muted rounded-xl shadow-[0_4px_10px_rgba(0,0,0,0.12)]",children:[r.jsx(w,{children:r.jsx(k,{className:"text-3xl flex items-center",children:"Lista de Productos"})}),r.jsx(D,{className:"p-6 overflow-x-auto",children:r.jsx(N,{columns:f,data:b,mostrarEditar:!0,mostrarAgregarNuevo:!0,mostrarEliminar:!0,onAgregarNuevoClick:p,onEditarClick:x,onEliminarClick:g})})]}),r.jsx(P,{open:m,onOpenChange:t,children:r.jsxs(v,{className:"min-w-[420px] max-w-xl",children:[r.jsxs(E,{children:[r.jsx(S,{children:"Agregar Producto"}),r.jsx(T,{children:"Completa la información del nuevo producto"})]}),r.jsx(z,{onClose:()=>t(!1),onSaved:s})]})})]})}export{B as default};
