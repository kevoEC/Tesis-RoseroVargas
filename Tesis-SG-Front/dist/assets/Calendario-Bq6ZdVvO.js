import{f as p,u as E,c as j,r as m,j as e,G as y,L as g,I as l,B as f,t as x}from"./index-ABbIRX4x.js";import{g as P,u as N}from"./CalendarioOperacionesService-Pd8v99_L.js";function G(){const{id:t}=p(),o=E(),{user:i}=j(),[c,d]=m.useState(!0),[s,C]=m.useState({nombre:"",fechaCorte:"",calendarioInversiones:"1",fechaGenerarPagos:"",fechaEnvioEECC:"",estadoProcesoPagos:!1,estadoProcesoEnvioEECC:!1,estadoCalendario:!1});m.useEffect(()=>{(async()=>{try{const a=await P(t);C({nombre:a.nombre,fechaCorte:a.fechaCorte?a.fechaCorte.split("T")[0]:"",calendarioInversiones:a.calendarioInversiones.toString(),fechaGenerarPagos:a.fechaGenerarPagos?a.fechaGenerarPagos.split("T")[0]:"",fechaEnvioEECC:a.fechaEnvioEECC?a.fechaEnvioEECC.split("T")[0]:"",estadoProcesoPagos:a.estadoProcesoPagos,estadoProcesoEnvioEECC:a.estadoProcesoEnvioEECC,estadoCalendario:a.estadoCalendario})}catch(a){x.error("Error al cargar calendario: "+(a.message??a)),o("/calendario/vista")}finally{d(!1)}})()},[t,o]);const n=(r,a)=>{C(b=>({...b,[r]:a}))},v=async r=>{r.preventDefault(),d(!0);try{const a={nombre:s.nombre,fechaCorte:s.fechaCorte?new Date(s.fechaCorte).toISOString():null,calendarioInversiones:s.calendarioInversiones,fechaGenerarPagos:s.fechaGenerarPagos?new Date(s.fechaGenerarPagos).toISOString():null,fechaEnvioEECC:s.fechaEnvioEECC?new Date(s.fechaEnvioEECC).toISOString():null,estadoProcesoPagos:s.estadoProcesoPagos,estadoProcesoEnvioEECC:s.estadoProcesoEnvioEECC,estadoCalendario:s.estadoCalendario,idUsuarioModificacion:i.id};await N(t,a),x.success("Calendario actualizado correctamente"),o("/calendario/vista")}catch(a){x.error("Error al actualizar calendario: "+(a.message??a))}finally{d(!1)}};return c?e.jsx(y,{visible:!0,message:"Cargando calendario..."}):e.jsxs("div",{className:"p-8 space-y-6 relative",children:[e.jsx("header",{className:"flex flex-col md:flex-row md:items-center md:justify-between border-b pb-5 mb-5 gap-2",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 leading-tight flex items-center gap-2",children:[s.nombre,e.jsx("span",{className:"text-xs font-medium text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full ml-2",children:s.estadoCalendario?"CERRADO":"ABIERTO"})]}),e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wider mt-1",children:"Calendario de operaciones"})]})}),e.jsxs("form",{onSubmit:v,className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("section",{className:"space-y-5 bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsx("h2",{className:"font-semibold text-lg text-gray-800 mb-2",children:"General"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{className:"block text-sm font-medium mb-1",children:"Nombre *"}),e.jsx(l,{value:s.nombre,onChange:r=>n("nombre",r.target.value),required:!0})]}),e.jsx(h,{label:"Fecha de Corte *",children:e.jsx(l,{type:"date",value:s.fechaCorte,onChange:r=>n("fechaCorte",r.target.value),required:!0})}),e.jsxs("div",{children:[e.jsx(g,{className:"block text-sm font-medium mb-1",children:"Día de Inversiones *"}),e.jsx("select",{className:"w-full border rounded-md p-2 bg-white text-sm",value:s.calendarioInversiones,onChange:r=>n("calendarioInversiones",r.target.value),required:!0,children:[...Array(31)].map((r,a)=>e.jsx("option",{value:a+1,children:a+1},a+1))})]})]})]}),e.jsxs("section",{className:"space-y-5 bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsx("h2",{className:"font-semibold text-lg text-gray-800 mb-2",children:"Fechas Clave"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(h,{label:"Fecha para Generar Pagos *",children:e.jsx(l,{type:"date",value:s.fechaGenerarPagos,onChange:r=>n("fechaGenerarPagos",r.target.value),required:!0})}),e.jsx(h,{label:"Fecha para Envío de EECC *",children:e.jsx(l,{type:"date",value:s.fechaEnvioEECC,onChange:r=>n("fechaEnvioEECC",r.target.value),required:!0})})]})]}),e.jsxs("section",{className:"space-y-5 bg-gray-50 rounded-xl border border-gray-100 p-6 shadow-none",children:[e.jsx("h2",{className:"font-semibold text-lg text-gray-800 mb-2",children:"Estados del Calendario"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{label:"Proceso de Pagos",value:s.estadoProcesoPagos,textoActivo:"Completado",textoInactivo:"Pendiente"}),e.jsx(u,{label:"Envío de EECC",value:s.estadoProcesoEnvioEECC,textoActivo:"Completado",textoInactivo:"Pendiente"}),e.jsx(u,{label:"Estado del Calendario",value:s.estadoCalendario,textoActivo:"Cerrado",textoInactivo:"Abierto"})]})]}),e.jsxs("div",{className:"md:col-span-3 flex justify-end gap-4 pt-8 border-t mt-8",children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>o("/calendario/vista"),className:"px-6 py-2",children:"Cancelar"}),e.jsx(f,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2",children:"Guardar Cambios"})]})]})]})}function h({label:t,children:o}){return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(g,{className:"text-sm font-medium text-gray-700",children:t}),o]})}function u({label:t,value:o,textoActivo:i,textoInactivo:c}){return e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("span",{className:"font-medium text-gray-700",children:t}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${o?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:o?i:c})]})}export{G as default};
